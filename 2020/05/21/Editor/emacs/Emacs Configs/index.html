<!DOCTYPE html>
<html lang="zh-CN">
  <head><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="Emacs Configs"/><link rel="alternate" href="/atom.xml" title="Yikes">
<link rel="canonical" href="http://blog.gloomynan.com/2020/05/21/Editor/emacs/Emacs Configs/"/>


<link rel="stylesheet" type="text/css" href="/css/style.css?v=" />

<script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":"","toc":"","fancybox":"","pjax":"","latex":""};
</script>

    <title>Emacs Configs - Yikes</title>
  <meta name="generator" content="Hexo 4.2.1"></head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Yikes</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Yikes</a>
</div>

<nav class="site-navbar"></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><article class="post">
    <header class="post-header">
      <h1 class="post-title">Emacs Configs
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2020-05-21
        </span></div>
    </header>

    <div class="post-content"><h2 id="kbd"><a href="#kbd" class="headerlink" title="kbd"></a>kbd</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">C-s b <span class="comment">;;切换buffer</span></span><br><span class="line">C-x b /C-x C-b<span class="comment">;切换buffer</span></span><br><span class="line">M-x customize-group <span class="comment">;;定制配置</span></span><br><span class="line">C-x C-e <span class="comment">;;scratch模式，执行lisp代码</span></span><br><span class="line">M-n M-p<span class="comment">;;选取补全内容</span></span><br><span class="line">C-x r C-h <span class="comment">;列出所有C-x r前缀的命令</span></span><br><span class="line">C-h C-h  <span class="comment">;给出帮助相关命令</span></span><br><span class="line">M-x lisp-interaction-mode <span class="comment">;切换到lisp解释器模式</span></span><br><span class="line">C-x C-e <span class="comment">;执行lisp程序to Minibuffer</span></span><br><span class="line">C-x n <span class="comment">;分屏 1/0 关闭其他 2下 3 右</span></span><br><span class="line">emacs -nw <span class="comment">;终端模式打开emacs</span></span><br><span class="line">/sudo::/path ;提权编辑</span><br><span class="line"><span class="comment">;切换buffer  "C-x &lt;left&gt;" 和 "C-x &lt;right&gt;"</span></span><br><span class="line">C-x C-w   <span class="comment">; 按提示输入文件名，另存为</span></span><br><span class="line">M-x customize-variable 回;车 make-backup-files 回车     关掉文件备份</span><br><span class="line">M-s ： ;新建一个buffer（缓冲区） </span><br><span class="line">C-x 3 ： ;把缓冲区（buffer）分为左右两个，新的一个缓冲区是复制当前的缓冲区 （可以执行多次，来分割出很多小窗口） </span><br><span class="line">C-x 2 ： ;把缓冲区（buffer）分为上下两个，新的一个缓冲区是复制当前的缓冲区 （可以执行多次，来分割出很多小窗口） </span><br><span class="line">M-w ： ;选中文字的情况是复制文字，而如果没有选中文字则是复制当前的一行 </span><br><span class="line">C-w ： ;选中文字的情况是剪切文字，而如果没有选中文字则是剪切当前的一行 </span><br><span class="line">M-x ： ;调出命令输入，可以在后面接命令，比如man，svn-status，等 </span><br><span class="line">C-x C-v ：; 打开一个文件，取代当前缓冲区 </span><br><span class="line">C-x k ： ;关闭当前缓冲区（buffer） </span><br><span class="line">C-x h ： ;全选 </span><br><span class="line">C-@ ： ;标记开始区域 </span><br><span class="line">C-x <span class="number">5</span> <span class="number">2</span> <span class="comment">;新建frame</span></span><br><span class="line">C-x <span class="number">50</span>  <span class="comment">;关闭frame </span></span><br><span class="line">M-&gt; ： ;缓冲区尾部 M-g M-g，再输入数字 ： 跳转到文本的第几行 </span><br><span class="line">C-x 0 ： ;关闭当前缓冲区 </span><br><span class="line"><span class="comment">; 野蛮点的方法，调用函数kill-emacs，即M-x kill-emacs，直接退出，不管是否修改。</span></span><br><span class="line"><span class="comment">;不过直接退出后，Emacs会在相同目录下保留一个以#号开头结尾的相同文件名文件，下次启动可以使用M-x recover-file来恢复。如果是多次保存后，还会有个以~结尾的文件，保存了上次信息。</span></span><br><span class="line"><span class="comment">;shell可以 M-x shell 或者 M-x term 进入 Shell.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">;;Emacs在保存时就会运行write-file-hooks中的time-stamp, 从而加 入修改时间, 结果类似下面所示</span></span><br><span class="line"><span class="comment">;;Time-stamp: </span></span><br><span class="line"><span class="comment">;;或者</span></span><br><span class="line"><span class="comment">;;Time-stamp: "jerry 12/17/2003 12:00:54 (unidevel.com)"</span></span><br><span class="line">   </span><br><span class="line"><span class="comment">;要使用中文表示, 可以这样设置</span></span><br><span class="line">(<span class="name">setq</span> time-stamp-start <span class="string">"最后更新时间:[     ]+\\\\?"</span>)</span><br><span class="line">(<span class="name">setq</span> time-stamp-end: <span class="string">"\n"</span>)</span><br><span class="line">(<span class="name">setq</span> time-stamp-format: <span class="string">"%:y年%:m月%:d日"</span>)</span><br><span class="line"><span class="comment">;;上面设置了如果碰到"最后更新时间:"的字样, time-stamp就将其后 面的字符替换为当前时间的"XXXX年XX月XX日", 注意, time-stamp-end的结束符 为换行符, 所以"最后更新时间:"行后所有字符都将无条件被替换为"XXXX年XX月XX日" 格式的时间, 本文首页上的更新时间就是这样做出来的</span></span><br><span class="line">   </span><br><span class="line"><span class="comment">;启动Emacs报错, ~/.emacs中有问题, 如何忽略错误</span></span><br><span class="line"> (<span class="name">condition-case</span> err</span><br><span class="line">     (<span class="name">progn</span></span><br><span class="line">     (<span class="name">require</span> 'xxx) )</span><br><span class="line">   (<span class="name">error</span></span><br><span class="line">    (<span class="name">message</span> <span class="string">"Can't load xxx-mode %s"</span> (<span class="name">cdr</span> err))))</span><br><span class="line">   </span><br><span class="line"><span class="comment">;如上所示, 可以截获progn内部出错, 在mini-buffer下打出错误信息</span></span><br></pre></td></tr></table></figure>

<p><img src="media/14963272150143/Emacs%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C.png" alt="Emacs基本操作-w1000"></p>
<p><img src="media/14963272150143/e-nav.png" alt="e-nav"></p>
<h2 id="urls"><a href="#urls" class="headerlink" title="urls"></a>urls</h2><p><a href="https://www.emacswiki.org/emacs/MetaKeyProblems" target="_blank" rel="noopener">MetaKeyProblems</a><br><a href="https://docs.huihoo.com/homepage/shredderyin/emacs.html" target="_blank" rel="noopener">王垠笔记</a><br><a href="https://www.emacswiki.org" target="_blank" rel="noopener">emacs wiki</a><br><a href="http://dotemacs.de" target="_blank" rel="noopener">The very unofficial dotemacs home</a><br><a href="http://smacs.github.io/elisp/" target="_blank" rel="noopener">Emacs Lisp 简明教程</a><br><a href="https://emacs-china.org" target="_blank" rel="noopener">Emacs China</a><br><a href="https://www.jianshu.com/p/7432c3bfcc99" target="_blank" rel="noopener">解决Mac下emacs中alt键不能使用问题</a></p>
<h3 id="blogs"><a href="#blogs" class="headerlink" title="blogs"></a>blogs</h3><p><a href="https://planet.emacslife.com/" target="_blank" rel="noopener">planet emacs</a><br><a href="">irrel emacs</a><br>abo abo emacs<br><a href="http://blog.binchen.org/">chenbin emacs</a><br><a href="https://sachachua.com/blog/welcome/" target="_blank" rel="noopener">emacs sacha</a></p>
<h2 id="Emacs-mode"><a href="#Emacs-mode" class="headerlink" title="Emacs mode"></a>Emacs mode</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">linum-mode <span class="comment">;display line numbers</span></span><br><span class="line">(<span class="name">mouse-avoidance-mode</span> 'jump) <span class="comment">;光标靠近树表示让鼠标自动走开</span></span><br><span class="line">(<span class="name">delete-selection-mode</span> <span class="literal">t</span>) <span class="comment">;;delete键</span></span><br><span class="line">(<span class="name">tool-bar-mode</span> <span class="number">-1</span>) <span class="comment">; turn off tool-bar</span></span><br><span class="line">(<span class="name">scroll-bar-mode</span> <span class="number">-1</span>) <span class="comment">; turn off scroll-bar</span></span><br><span class="line">(<span class="name">global-linum-mode</span> <span class="literal">t</span>)</span><br><span class="line">(<span class="name">global-font-lock-mode</span> <span class="literal">t</span>) <span class="comment">;打开语法高亮</span></span><br><span class="line">(<span class="name">electirc-indent-mode</span> <span class="literal">t</span>) <span class="comment">;;自动缩进 注释用两个引号</span></span><br><span class="line">(<span class="name">auto-image-file-mode</span> <span class="literal">t</span>) <span class="comment">;让Emacs可以直接打开、显示图片</span></span><br><span class="line">(<span class="name">setq</span> column-number-mode <span class="literal">t</span>) <span class="comment">;显示列号</span></span><br><span class="line">(<span class="name">blobal-hl-line-mode</span> <span class="literal">t</span>)<span class="comment">;;显示当前行</span></span><br><span class="line">(<span class="name">show-paren-mode</span> <span class="literal">t</span>)<span class="comment">;;; 括号匹配时显示另一个括号而不是跳到另一个括号</span></span><br><span class="line"><span class="comment">; add delete selection mode</span></span><br><span class="line">(<span class="name">delete-selection-mode</span> <span class="literal">t</span>)</span><br><span class="line">(<span class="name">transient-mark-mode</span> <span class="literal">t</span>) <span class="comment">; high light copy area</span></span><br></pre></td></tr></table></figure>
<h3 id="config"><a href="#config" class="headerlink" title="config"></a>config</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; config</span></span><br><span class="line">(<span class="name">set</span> make-backup-files <span class="literal">nil</span>) <span class="comment">;disable backup files</span></span><br><span class="line">(<span class="name">load-theme</span> `mokial-theme <span class="literal">t</span>) <span class="comment">;;启动皮肤</span></span><br><span class="line">(<span class="name">add-hook</span> 'emacs-list-mode-hook 'show-paren-mode) <span class="comment">;; 高亮对应括号</span></span><br><span class="line">(<span class="name">setq</span> inhibit-startup-message <span class="literal">t</span>) <span class="comment">;关闭启动画面</span></span><br><span class="line">(<span class="name">setq</span> inhibit-splash-screen <span class="literal">t</span>) <span class="comment">;turn off splash screen</span></span><br><span class="line">(<span class="name">setq</span> show-paren-style 'parentheses)</span><br><span class="line">(<span class="name">setq</span> frame-title-format <span class="string">"%b %I"</span>) <span class="comment">;显示文件名和大小</span></span><br><span class="line">(<span class="name">fset</span> 'yes-or-no-p 'y-or-n-p) <span class="comment">;以Y/N代表yes/no</span></span><br><span class="line">(<span class="name">setq</span> auto-save-default <span class="literal">nil</span>) <span class="comment">;不生成名为#filename#的临时文件</span></span><br><span class="line">(<span class="name">setq</span> x-select-enable-clipboard <span class="literal">t</span>) <span class="comment">;支持和外部程序的拷贝</span></span><br><span class="line">(<span class="name">display-time</span>)</span><br><span class="line">(<span class="name">setq</span> visible-bell <span class="literal">t</span>) <span class="comment">; remove beeping</span></span><br><span class="line">(<span class="name">show-paren-mode</span> <span class="literal">t</span>) <span class="comment">;匹配的括号</span></span><br><span class="line"><span class="comment">;为什么使用语法显示的大文件在移动时如此之慢</span></span><br><span class="line">(<span class="name">setq</span> lazy-lock-defer-on-scrolling <span class="literal">t</span>)</span><br><span class="line">(<span class="name">setq</span> font-lock-support-mode 'lazy-lock-mode)</span><br><span class="line"></span><br><span class="line">(<span class="name">setq</span> font-lock-maximum-decoration <span class="literal">t</span>) (<span class="name">package-initialize</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name">defun</span> open-my-init-file()</span><br><span class="line">    (<span class="name">interactive</span>)</span><br><span class="line">    (<span class="name">find-file</span> <span class="string">"~/.emacs.d/init.el"</span>))</span><br><span class="line"></span><br><span class="line">(<span class="name">global-set-key</span> (<span class="name">kbd</span> <span class="string">"&lt;f2&gt;"</span>) 'open-my-init-file)</span><br><span class="line">(<span class="name">setq</span> curcor-tpye 'bar)</span><br><span class="line">(<span class="name">custom-set-variables</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Survive-in-Emacs"><a href="#Survive-in-Emacs" class="headerlink" title="Survive in Emacs"></a>Survive in Emacs</h2><p>快捷键补充<br>S:shift<br>s:super</p>
<p>buffer名字有<em><em>号代表不关联某个文件，例如\</em>Scratch\</em></p>
<p>参数<br>C-9 * 插入九个星号<br>如果超过9需要C-u 例如 C-u 60 *<br>F3录制宏 F4结束宏录制 C-x eee执行三次，或者C-3 F4</p>
<h3 id="定制emacs"><a href="#定制emacs" class="headerlink" title="定制emacs"></a>定制emacs</h3><p>setq设置变量</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">set</span> variable value)</span><br><span class="line">函数式设置</span><br><span class="line"></span><br><span class="line"><span class="comment">; ido配置</span></span><br><span class="line">(<span class="name">require</span> 'ido)</span><br><span class="line">(<span class="name">setq</span> ido-enalbe-prefix <span class="literal">nil</span>)</span><br><span class="line">(<span class="name">setq</span> ido-enalbe-case <span class="literal">nil</span>)</span><br><span class="line">(<span class="name">ido-mode</span> <span class="literal">t</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">;;;; key binding</span></span><br><span class="line"><span class="comment">;;(global-set-key key command)</span></span><br><span class="line">(<span class="name">global-set-key</span> (<span class="name">kbd</span> <span class="string">"M-SPC"</span>) 'set-mark-command)</span><br><span class="line"></span><br><span class="line"><span class="comment">;再举一个例子，把 Ctrl+F9绑定到编译命令上：</span></span><br><span class="line">(<span class="name">global-set-key</span> (<span class="name">kbd</span> <span class="string">"&lt;c-f9&gt;"</span>) 'compile)</span><br><span class="line"></span><br><span class="line"><span class="comment">;; define-key = local-set-key</span></span><br><span class="line">(<span class="name">define-key</span> keymap key command)</span><br><span class="line"><span class="comment">;其中key和command都是和global-set-key类似的，不过现在需要指定为哪个mode定义快捷键。例如在编辑C程序的时候将F9绑定到编译命令上：</span></span><br><span class="line">(<span class="name">define-key</span> c-mode-map (<span class="name">kbd</span> <span class="string">"&lt;f9&gt;"</span>) 'compile)</span><br><span class="line"><span class="comment">;其中c-mode-map就是对应到c-mode的keymap ，一般各个mode都有独立的keymap ，并且以mode的名字加上 –map 来命名。</span></span><br></pre></td></tr></table></figure>

<h3 id="major-mode-hook"><a href="#major-mode-hook" class="headerlink" title="major-mode  hook"></a>major-mode  hook</h3><p>命名规则为XX-mode-hook</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">add-hook</span> 'c-mode-hook</span><br><span class="line">           '(lambda () ;匿名函数</span><br><span class="line">             ;; 自动换行功能</span><br><span class="line">             (c-toggle-auto-newline <span class="number">1</span>)</span><br><span class="line">             ;; 此模式下，当按Backspace时会删除最多的空格</span><br><span class="line">             (c-toggle-hungry-state)</span><br><span class="line">             ;; 显示目前光标在哪个函数里面</span><br><span class="line">             (which-function-mode <span class="literal">t</span>)</span><br><span class="line">             (auto-fill-mode <span class="literal">t</span>)</span><br><span class="line">             ;; 不使用 tab 作为缩进字符</span><br><span class="line">             (setq indent-tabs-mode <span class="literal">nil</span>)</span><br><span class="line">             (c-subword-mode <span class="number">1</span>))) </span><br><span class="line">lambda匿名函数</span><br><span class="line">(<span class="name">lambda</span> (<span class="name">x</span> y)</span><br><span class="line">  (<span class="name">message</span> x)</span><br><span class="line">  (<span class="name">message</span> y))</span><br><span class="line">  <span class="comment">;正常函数</span></span><br><span class="line">  (<span class="name">defun</span> foo(<span class="name">x</span> y)</span><br><span class="line">  (<span class="name">message</span> x)</span><br><span class="line">  (<span class="name">message</span> y))</span><br><span class="line">  </span><br><span class="line"><span class="comment">;另外，Elisp还允许为函数指定文档，紧跟在参数列表之后，例如：</span></span><br><span class="line">(<span class="name">defun</span> foo (<span class="name">x</span> y)</span><br><span class="line">  <span class="string">"Show X and Y in minibuffer.</span></span><br><span class="line"><span class="string">You may not see X in minibuffer because it</span></span><br><span class="line"><span class="string">is replaced by Y, but you can go to the</span></span><br><span class="line"><span class="string">*Messages* buffer and see it."</span></span><br><span class="line">  (<span class="name">message</span> x)</span><br><span class="line">  (<span class="name">message</span> y))</span><br><span class="line">  </span><br><span class="line">  <span class="comment">;另外，在Emacs中有一类特殊的函数，称为command ，它们可以被用户交互地调用（例如，绑定到某个快捷键上，或者通过M-x 输入命令名进行调用）。普通函数并不能通过交互方式直接被调用，要定义一个command ，需要在函数的文档字符串（如果有的话）之后调用interactive 。interactive 可以用于描述command所接受的参数以及如何获取这些参数等，详情可以参见Elisp手册里的相关内容。下面是一个例子，用于给一段文本加上一个很Cool的边框：</span></span><br><span class="line"></span><br><span class="line">(<span class="name">defun</span> kid-cool-box (<span class="name">title</span> begin end)</span><br><span class="line">  <span class="string">"Wrap the region with a cool box.</span></span><br><span class="line"><span class="string">The result is like this:</span></span><br><span class="line"><span class="string">,----------[ Title ]</span></span><br><span class="line"><span class="string">| This is the marked region</span></span><br><span class="line"><span class="string">| that will be boxed</span></span><br><span class="line"><span class="string">`----------</span></span><br><span class="line"><span class="string">"</span></span><br><span class="line">  (<span class="name">interactive</span> <span class="string">"sTitle: /nr"</span>)</span><br><span class="line">  (<span class="name">setq</span> end (<span class="name">copy-marker</span> end <span class="literal">t</span>))</span><br><span class="line">  (<span class="name">save-excursion</span></span><br><span class="line">    (<span class="name">goto-char</span> begin)</span><br><span class="line">    (<span class="name">unless</span> (<span class="name">looking-back</span> <span class="string">"^"</span>)</span><br><span class="line">      (<span class="name">insert</span> <span class="string">"/n"</span>))</span><br><span class="line">    (<span class="name">insert</span> <span class="string">",----------[ "</span>)</span><br><span class="line">    (<span class="name">insert</span> title)</span><br><span class="line">    (<span class="name">insert</span> <span class="string">" ]/n"</span>)</span><br><span class="line">    (<span class="name">while</span> (<span class="name">&lt;</span> (<span class="name">point</span>) end)</span><br><span class="line">      (<span class="name">insert</span> <span class="string">"| "</span>)</span><br><span class="line">      (<span class="name">next-line</span>)</span><br><span class="line">      (<span class="name">beginning-of-line</span>))</span><br><span class="line">    (<span class="name">goto-char</span> end)</span><br><span class="line">    (<span class="name">unless</span> (<span class="name">looking-back</span> <span class="string">"^"</span>)</span><br><span class="line">      (<span class="name">insert</span> <span class="string">"/n"</span>))</span><br><span class="line">    (<span class="name">insert</span> <span class="string">"`----------/n"</span>)))</span><br></pre></td></tr></table></figure>

<p><img src="media/File:Package%20Loding%20Mechanisms.jpg" alt="File:Package Loding Mechanisms"></p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; Make source code fancy in the org file.</span></span><br><span class="line">(<span class="name">require</span> 'org)</span><br><span class="line">(<span class="name">setq</span> org-src-fontify-natively <span class="literal">t</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">; enalbe recentf-mode</span></span><br><span class="line">(<span class="name">require</span> 'recentf)</span><br><span class="line">(<span class="name">recentf-mode</span> <span class="number">1</span>)</span><br><span class="line">(<span class="name">setq</span> recentf-max-menu-items <span class="number">25</span>)</span><br><span class="line">(<span class="name">global-set-key</span> <span class="string">"\C-x\ \c-r"</span> 'recentf-open-files)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">;; make pacaage system more powerful with Melpa</span></span><br><span class="line">(<span class="name">when</span> (<span class="name">&gt;=</span> emacs-major-version <span class="number">24</span>)</span><br><span class="line">  (<span class="name">require</span> 'package)</span><br><span class="line">  (<span class="name">package-initialize</span>)</span><br><span class="line">  (<span class="name">add-to-list</span> 'package-archives '(<span class="string">"melpa"</span> .<span class="string">"http://melpa.org/packages/"</span>) <span class="literal">t</span>)</span><br><span class="line">  (<span class="name">add-to-list</span> 'package-archives '(<span class="string">"popkit"</span> .<span class="string">"http://elpa.popkit.org/packages/"</span>))</span><br><span class="line">  (<span class="name">require</span> 'cl)</span><br><span class="line"></span><br><span class="line">  <span class="comment">;; add whatever packages you want here</span></span><br><span class="line">  (<span class="name">defvar</span> gloomynan/packages '(</span><br><span class="line">                               company</span><br><span class="line">                               ) <span class="string">"Default packages"</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name">setq</span> package-selected-packages gloomynan/packages)</span><br><span class="line">                               </span><br><span class="line">  (<span class="name">defun</span> gloomynan/packages-installeed-p ()</span><br><span class="line">    (<span class="name">loop</span> for pkg in gloomynan/packages</span><br><span class="line">	  when (<span class="name">not</span> (<span class="name">package-installed-p</span> pkg)) do (<span class="name">returen</span> <span class="literal">nil</span>)</span><br><span class="line">          finally (<span class="name">return</span> <span class="literal">t</span>)))</span><br><span class="line">  (<span class="name">unless</span> (<span class="name">gloomynan/packages-installed-p</span>)</span><br><span class="line">    (<span class="name">message</span> <span class="string">"%s"</span> <span class="string">"Refreshing package database..."</span>)</span><br><span class="line">    (<span class="name">package-refresh-contents</span>)</span><br><span class="line">    (<span class="name">dolist</span> (<span class="name">pkg</span> gloomynan/packages)</span><br><span class="line">      (<span class="name">when</span> (<span class="name">not</span> (<span class="name">package-installed-p</span> pkg))</span><br><span class="line">            (<span class="name">package-install</span> pkg)))</span><br><span class="line">            </span><br><span class="line">            (<span class="name">require</span> 'hungry-delete)</span><br><span class="line">(<span class="name">global-hungry-deleyte-mode</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name">require</span> 'smartparent-config)</span><br><span class="line"><span class="comment">;; (add-hook 'emacs-lisp-mode-hook 'smartparens-mode)</span></span><br><span class="line">(<span class="name">smartparens-global-mode</span> <span class="literal">t</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name">ivy-mode</span> <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">(<span class="name">setq</span> ivy-use-virtual-buffers <span class="literal">t</span>)</span><br><span class="line">(<span class="name">global-set-key</span> <span class="string">"\C-s"</span> 'swiper)</span><br><span class="line">(<span class="name">global-set-key</span> (<span class="name">kdb</span> <span class="string">"C-c C-r"</span>) 'ivty-resume)</span><br><span class="line">(<span class="name">global-set-key</span> (<span class="name">kdb</span> <span class="string">"M-x"</span>) 'counsel-M-x)</span><br><span class="line">(<span class="name">global-set-key</span> (<span class="name">kdb</span> <span class="string">"C-x C-f"</span>) 'counsel-find-file)</span><br><span class="line">(<span class="name">global-set-key</span> (<span class="name">kdb</span> <span class="string">"C-h f"</span>) 'counsel-describe-function)</span><br><span class="line">(<span class="name">global-set-key</span> (<span class="name">kdb</span> <span class="string">"C-h v"</span>) 'counsel-describe-variable)</span><br><span class="line">            </span><br><span class="line"><span class="comment">;; config js2-mode for js files</span></span><br><span class="line">(<span class="name">setq</span> auto-mode-alist</span><br><span class="line">      (<span class="name">append</span></span><br><span class="line">       '((<span class="string">"\\.js\\'"</span> . js2-mode))</span><br><span class="line">       auto-mode-alist))</span><br><span class="line"></span><br><span class="line">M-x global-auto-revert-mode <span class="comment">;;外部修改后自动重新加载配置文件</span></span><br><span class="line">(<span class="name">setq</span> auto-save-default <span class="literal">nil</span>)<span class="comment">;;自动保存禁止</span></span><br><span class="line"></span><br><span class="line">(<span class="name">add-to-list</span> `load-path <span class="string">"~/.emacs.d/lisp"</span>)<span class="comment">;;环境变量路径增加</span></span><br><span class="line"></span><br><span class="line"><span class="comment">;; 自定义变量自动补全</span></span><br><span class="line">(<span class="name">define-abbrev-table</span> 'global-abbrev-table '(</span><br><span class="line">                                            ;; signature</span><br><span class="line">                                            (<span class="string">"8zl"</span> <span class="string">"gloomynan"</span>)</span><br><span class="line">                                            ;; Microsoft</span><br><span class="line">                                            (<span class="string">"8ms"</span> <span class="string">"Macrosof"</span>)</span><br><span class="line">                                            ))</span><br><span class="line"><span class="comment">;; emacs-lisp 不要补全单引号</span></span><br><span class="line">(<span class="name">sp-local-pair</span> `emacs-lips-mode <span class="string">"'"</span> <span class="literal">nil</span> <span class="symbol">:actions</span> <span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">;; 鼠标触碰代码中间高亮两侧括号</span></span><br><span class="line">(<span class="name">define-adivce</span> show-paren-function (<span class="symbol">:around</span> (<span class="name">fn</span>) fix-show-paren-function)</span><br><span class="line">  <span class="string">"Highlight  enclosing parens."</span></span><br><span class="line">  (<span class="name">cond</span> ((<span class="name">looking-at-p</span> <span class="string">"\\s("</span>) funcall fn))</span><br><span class="line">  (<span class="name">t</span> (<span class="name">save-excursion</span></span><br><span class="line">       (<span class="name">ignore-errors</span> (<span class="name">backward-up-list</span>))</span><br><span class="line">       (<span class="name">funcall</span> fn)))))</span><br><span class="line">       </span><br><span class="line"><span class="comment">;; 隐藏doc换行符`^M`</span></span><br><span class="line"></span><br><span class="line">(<span class="name">defun</span> hidden-dos-eol ()</span><br><span class="line">  <span class="string">"Do not show ^M in files containing mixed UNIX and DOS line endings."</span></span><br><span class="line">  (<span class="name">interactive</span>)</span><br><span class="line">  (<span class="name">setq</span> buffer-display-table (<span class="name">make-display-table</span>))</span><br><span class="line">  (<span class="name">aset</span> buffer-display-table ?/^M []) )</span><br><span class="line">  </span><br><span class="line"><span class="comment">;; 删除doc换行符`^M`</span></span><br><span class="line">(<span class="name">defun</span> remove-dos-eol ()</span><br><span class="line">  <span class="string">"Replace DOS eolns CR LF with Unix eolns CR"</span></span><br><span class="line">  (<span class="name">interactive</span>)</span><br><span class="line">  (<span class="name">goto-cahr</span> (<span class="name">point-min</span>))</span><br><span class="line">  (<span class="name">while</span> (<span class="name">search-forward</span> <span class="string">"\r"</span> <span class="literal">nil</span> <span class="literal">t</span> ) (<span class="name">replace-match</span> <span class="string">""</span>)))</span><br><span class="line">  </span><br><span class="line"><span class="comment">; 快捷键右侧buffer提示</span></span><br><span class="line">(<span class="name">whick-key-mode</span> <span class="number">1</span>)</span><br><span class="line">  (<span class="name">setq</span> which-key-side-window-location 'right)</span><br></pre></td></tr></table></figure>

<h3 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h3><ul>
<li>init-packages.el</li>
<li>init-ui,el</li>
<li>init-better-defaults.el</li>
<li>init.keybindings.el</li>
<li>custom.el</li>
</ul>
<h3 id="第六集"><a href="#第六集" class="headerlink" title="第六集"></a>第六集</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">;;;抓取chrom链接</span></span><br><span class="line">(<span class="name">defun</span> zilongshanren/indert-chrome-current-tab-url ()</span><br><span class="line">  <span class="string">"Get the URL of the active tab of the first window"</span></span><br><span class="line">  (<span class="name">interactive</span>)</span><br><span class="line">  (<span class="name">insert</span> (<span class="name">zilongshanren/retrieve-chrome-current-tab-url</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="name">defun</span> zilongshanren/retirieve-chrome-current-tab-url ()</span><br><span class="line">  <span class="string">"Get the URL of the active tab of the first window"</span></span><br><span class="line">  (<span class="name">interactive</span>)</span><br><span class="line">  (<span class="name">let</span> ((<span class="name">result</span> (<span class="name">do-applescript</span></span><br><span class="line">                 (<span class="name">concat</span></span><br><span class="line">                  <span class="string">"set frontmostApplication to path to frontmost application\n"</span></span><br><span class="line">                  <span class="string">"tell application \"Glogle Chrome \"\n"</span></span><br><span class="line">                  <span class="string">" set the Url to get URL of active tab of first window\n"</span></span><br><span class="line">                  <span class="string">"set theResult to (get theUrl \n)"</span></span><br><span class="line">                  <span class="string">"end tell\n"</span></span><br><span class="line">                  <span class="string">"activate application (frontmostApplication as text)\n"</span></span><br><span class="line">                  <span class="string">"set links to &#123;&#125;\n"</span></span><br><span class="line">                  <span class="string">"copy theResult to the end of links\n"</span></span><br><span class="line">                  <span class="string">"reture links as string\n"</span>))))</span><br><span class="line">    (<span class="name">fromat</span> <span class="string">"%s"</span> (<span class="name">s-chop-suffix</span> <span class="string">"\""</span> result))))</span><br></pre></td></tr></table></figure>

<h3 id="others"><a href="#others" class="headerlink" title="others"></a>others</h3><p>lispy vi-like Paredit<br>ctags 大型代码库索引自动补全<br>动态语言无法语义补全（lua/javascript）<br>elisp入门 叶文斌</p>
<h3 id="Evolve-with-the-community"><a href="#Evolve-with-the-community" class="headerlink" title="Evolve with the community"></a>Evolve with the community</h3><ul>
<li>reddit/r/emacs</li>
<li>emacs-china.org</li>
<li>twitter/emacs</li>
<li>github/spacemacs/prelude/purecll/abo-abo</li>
<li>RSS</li>
</ul>
<h3 id="Mark"><a href="#Mark" class="headerlink" title="Mark"></a>Mark</h3><p>参数 C-u = M-</p>
<h2 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h2><p>Ctrl+r<br>bing命令<br>M-x eval-buffer 状态机生效<br>函数 nodejs-repl-send-buffer代码发动到buffer运行<br>缩写+全称<br>lisp无namespace,vars全局可见<br><strong>魔法注释</strong><br><code>;;;###autoload</code><br><code>;;插件名-autoloads.el</code>是自动生成的，遍历插件陌路所有文件的魔法注释生成</p>
<p>load-file 和 require<br>x 执行<br>C-x C-z 打开当前文件所在buffer<br>C-c 复制<br>open finder on Mac<br>Packages<br>reveal-in-osx-finder</p>
<p>M-; 注释</p>
<h2 id="expand-region"><a href="#expand-region" class="headerlink" title="expand-region"></a>expand-region</h2><p>键盘快速选中字符串<br>C-=/-</p>
<p>C-w<br>command-log<br>pallet + cask管理插件包<br>macro  宏<br>use-package</p>
<h2 id="package-list-packages"><a href="#package-list-packages" class="headerlink" title="package-list-packages"></a>package-list-packages</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">require</span> 'XX)</span><br><span class="line">(<span class="name">add-to-list</span> 'load-path</span><br><span class="line">	     <span class="string">"~/emacs/extension"</span></span><br><span class="line">	     <span class="literal">t</span>)</span><br></pre></td></tr></table></figure>

<p>i-选择安装<br>u-取消选择<br>d-删除<br>x-执行</p>
<p>自动删除无用包<br>packages-auto-remove</p>
<p>emacs 24以后自动支持了elpa包管理功能,直接 package-list-packages 列出插件来,然后 Ctrl-s 搜索插件,选择安装就可以.这样很是方便,本来以为这样就可以了,但是随着时间推移,插件列表中出现了大量的插件版本,并且有很多 obsolete 标识的插件.所以想到了我需要elpa来更新插件和删除插件.</p>
<a id="more"></a>
<p>更新管理插件需要进入package-list中进行操作:</p>
<p>package-list-packages 进入列表<br>package-menu-mark-upgrade [U] 设置更新标识<br>package-menu-execute [x]执行更新操作<br>完成更新操作.</p>
<p>emacs 24 以前的版本需要安装elpa package插件来实现以上功能.</p>

      </div>
      
      <footer class="post-footer">
        
        <nav class="post-nav"><a class="prev" href="/2020/05/21/Editor/emacs/emacs%E6%89%8B%E5%86%8C/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Editor/emacs/emacs手册</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    <a class="next" href="/2020/05/21/Editor/VI%20/vim_del/">
        <span class="next-text nav-default">VIM</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></footer>
    </article></div><div class="comments" id="comments"></div></div>
      </main>

      <footer id="footer" class="footer"><div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even" target="_blank" rel="noopener">Even</a>
  </span>

  <span class="copyright-year">&copy;2020<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Gloomy楠</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v="></script>
</body>
</html>
