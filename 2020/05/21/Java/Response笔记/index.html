<!DOCTYPE html>
<html lang="zh-CN">
  <head><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="Java/Response笔记"/><link rel="alternate" href="/atom.xml" title="Yikes">
<link rel="canonical" href="http://blog.gloomynan.com/2020/05/21/Java/Response笔记/"/>


<link rel="stylesheet" type="text/css" href="/css/style.css?v=" />

<script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":"","toc":"","fancybox":"","pjax":"","latex":""};
</script>

    <title>Java/Response笔记 - Yikes</title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Yikes</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Yikes</a>
</div>

<nav class="site-navbar"></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><article class="post">
    <header class="post-header">
      <h1 class="post-title">Java/Response笔记
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2020-05-21
        </span></div>
    </header>

    <div class="post-content"><h2 id="HTTP协议："><a href="#HTTP协议：" class="headerlink" title="HTTP协议："></a>HTTP协议：</h2><h3 id="请求消息：客户端发送给服务器端的数据"><a href="#请求消息：客户端发送给服务器端的数据" class="headerlink" title="请求消息：客户端发送给服务器端的数据"></a>请求消息：客户端发送给服务器端的数据</h3><p>数据格式：</p>
<ol>
<li>请求行</li>
<li>请求头</li>
<li>请求空行</li>
<li>请求体</li>
</ol>
<h3 id="响应消息：服务器端发送给客户端的数据"><a href="#响应消息：服务器端发送给客户端的数据" class="headerlink" title="响应消息：服务器端发送给客户端的数据"></a>响应消息：服务器端发送给客户端的数据</h3><ul>
<li>数据格式：</li>
</ul>
<ol>
<li>响应行</li>
<li>组成：协议/版本 响应状态码 状态码描述</li>
<li>响应状态码：服务器告诉客户端浏览器本次请求和响应的一个状态。</li>
<li>状态码都是3位数字 </li>
<li>分类：<ol>
<li>1xx：服务器就收客户端消息，但没有接受完成，等待一段时间后，发送1xx多状态码</li>
<li>2xx：成功。代表：200</li>
<li>3xx：重定向。代表：302(重定向)，304(访问缓存)</li>
<li>4xx：客户端错误。</li>
</ol>
</li>
</ol>
<ul>
<li>代表：</li>
<li>404（请求路径没有对应的资源） </li>
<li>405：请求方式没有对应的doXxx方法</li>
</ul>
<ol start="5">
<li>5xx：服务器端错误。代表：500(服务器内部出现异常)</li>
</ol>
<ol start="2">
<li>响应头：</li>
<li>格式：头名称： 值</li>
<li>常见的响应头：</li>
<li>Content-Type：服务器告诉客户端本次响应体数据格式以及编码格式</li>
<li>Content-disposition：服务器告诉客户端以什么格式打开响应体数据</li>
</ol>
<ul>
<li>值：</li>
<li>in-line:默认值,在当前页面内打开</li>
<li>attachment;filename=xxx：以附件形式打开响应体。文件下载</li>
</ul>
<ol start="3">
<li>响应空行</li>
<li>响应体:传输的数据</li>
</ol>
<ul>
<li>响应字符串格式<br>HTTP/1.1 200 OK<br>Content-Type: text/html;charset=UTF-8<br>Content-Length: 101<br>Date: Wed, 06 Jun 2018 07:08:42 GMT</li>
</ul>
<html>
  <head>
    <title>$Title$</title>
  <meta name="generator" content="Hexo 4.2.1"></head>
  <body>
  hello , response
  </body>
</html>



<h2 id="Response对象"><a href="#Response对象" class="headerlink" title="Response对象"></a>Response对象</h2><ul>
<li>功能：设置响应消息</li>
</ul>
<ol>
<li><p>设置响应行</p>
</li>
<li><p>格式：HTTP/1.1 200 ok</p>
</li>
<li><p>设置状态码：setStatus(int sc) </p>
</li>
<li><p>设置响应头：setHeader(String name, String value) </p>
</li>
<li><p>设置响应体：</p>
</li>
</ol>
<ul>
<li>使用步骤：</li>
</ul>
<ol>
<li>获取输出流</li>
</ol>
<ul>
<li><p>字符输出流：PrintWriter getWriter()</p>
</li>
<li><p>字节输出流：ServletOutputStream getOutputStream()</p>
</li>
</ul>
<ol start="2">
<li>使用输出流，将数据输出到客户端浏览器</li>
</ol>
<ul>
<li>案例：</li>
</ul>
<ol>
<li>完成重定向</li>
</ol>
<ul>
<li>重定向：资源跳转的方式</li>
<li>代码实现：<br>//1. 设置状态码为302<pre><code>response.setStatus(302);
//2.设置响应头location
response.setHeader(&quot;location&quot;,&quot;/day15/responseDemo2&quot;);</code></pre></li>
</ul>
<pre><code>//简单的重定向方法
response.sendRedirect(&quot;/day15/responseDemo2&quot;);</code></pre><ul>
<li>重定向的特点:redirect</li>
</ul>
<ol>
<li>地址栏发生变化</li>
<li>重定向可以访问其他站点(服务器)的资源</li>
<li>重定向是两次请求。不能使用request对象来共享数据</li>
</ol>
<ul>
<li>转发的特点：forward</li>
</ul>
<ol>
<li>转发地址栏路径不变</li>
<li>转发只能访问当前服务器下的资源</li>
<li>转发是一次请求，可以使用request对象来共享数据</li>
</ol>
<ul>
<li><p>forward 和  redirect 区别</p>
</li>
<li><p>路径写法：</p>
</li>
</ul>
<ol>
<li>路径分类</li>
<li>相对路径：通过相对路径不可以确定唯一资源</li>
</ol>
<ul>
<li><p>如：./index.html</p>
</li>
<li><p>不以/开头，以.开头路径</p>
</li>
<li><p>规则：找到当前资源和目标资源之间的相对位置关系</p>
</li>
<li><p>./：当前目录</p>
</li>
<li><p>../:后退一级目录</p>
</li>
</ul>
<ol start="2">
<li>绝对路径：通过绝对路径可以确定唯一资源</li>
</ol>
<ul>
<li><p>如：<a href="http://localhost/day15/responseDemo2/day15/responseDemo2" target="_blank" rel="noopener">http://localhost/day15/responseDemo2/day15/responseDemo2</a></p>
</li>
<li><p>以/开头的路径</p>
</li>
<li><p>规则：判断定义的路径是给谁用的？判断请求将来从哪儿发出</p>
</li>
<li><p>给客户端浏览器使用：需要加虚拟目录(项目的访问路径)</p>
</li>
<li><p>建议虚拟目录动态获取：request.getContextPath()</p>
</li>
<li><p><a> , <form> 重定向…</p>
</li>
<li><p>给服务器使用：不需要加虚拟目录</p>
</li>
<li><p>转发路径</p>
</li>
</ul>
<ol start="2">
<li>服务器输出字符数据到浏览器</li>
</ol>
<ul>
<li>步骤：</li>
</ul>
<ol>
<li>获取字符输出流</li>
<li>输出数据</li>
</ol>
<ul>
<li>注意：</li>
<li>乱码问题：</li>
</ul>
<ol>
<li>PrintWriter pw = response.getWriter();获取的流的默认编码是ISO-8859-1</li>
<li>设置该流的默认编码</li>
<li>告诉浏览器响应体使用的编码</li>
</ol>
<p>//简单的形式，设置编码，是在获取流之前设置<br>        response.setContentType(“text/html;charset=utf-8”);<br>3. 服务器输出字节数据到浏览器</p>
<ul>
<li>步骤：</li>
</ul>
<ol>
<li><p>获取字节输出流</p>
</li>
<li><p>输出数据</p>
</li>
<li><p>验证码</p>
</li>
<li><p>本质：图片</p>
</li>
<li><p>目的：防止恶意表单注册</p>
</li>
</ol>
<h2 id="ServletContext对象："><a href="#ServletContext对象：" class="headerlink" title="ServletContext对象："></a>ServletContext对象：</h2><ol>
<li>概念：代表整个web应用，可以和程序的容器(服务器)来通信</li>
<li>获取：</li>
<li>通过request对象获取<br>request.getServletContext();</li>
<li>通过HttpServlet获取<br>this.getServletContext();</li>
<li>功能：</li>
<li>获取MIME类型：</li>
</ol>
<ul>
<li><p>MIME类型:在互联网通信过程中定义的一种文件数据类型</p>
</li>
<li><p>格式： 大类型/小类型   text/htmlimage/jpeg</p>
</li>
<li><p>获取：String getMimeType(String file)  </p>
</li>
</ul>
<ol start="2">
<li>域对象：共享数据</li>
<li>setAttribute(String name,Object value)</li>
<li>getAttribute(String name)</li>
<li>removeAttribute(String name)</li>
</ol>
<ul>
<li>ServletContext对象范围：所有用户所有请求的数据</li>
</ul>
<ol start="3">
<li><p>获取文件的真实(服务器)路径</p>
</li>
<li><p>方法：String getRealPath(String path)<br>String b = context.getRealPath(“/b.txt”);//web目录下资源访问</p>
<pre><code> System.out.println(b);

String c = context.getRealPath(&quot;/WEB-INF/c.txt&quot;);//WEB-INF目录下的资源访问
System.out.println(c);

String a = context.getRealPath(&quot;/WEB-INF/classes/a.txt&quot;);//src目录下的资源访问
System.out.println(a);</code></pre></li>
</ol>
<h2 id="案例："><a href="#案例：" class="headerlink" title="案例："></a>案例：</h2><ul>
<li>文件下载需求：</li>
</ul>
<ol>
<li>页面显示超链接</li>
<li>点击超链接后弹出下载提示框</li>
<li>完成图片文件下载</li>
</ol>
<ul>
<li>分析：</li>
</ul>
<ol>
<li>超链接指向的资源如果能够被浏览器解析，则在浏览器中展示，如果不能解析，则弹出下载提示框。不满足需求</li>
<li>任何资源都必须弹出下载提示框</li>
<li>使用响应头设置资源的打开方式：</li>
</ol>
<ul>
<li>content-disposition:attachment;filename=xxx</li>
</ul>
<ul>
<li>步骤：</li>
</ul>
<ol>
<li>定义页面，编辑超链接href属性，指向Servlet，传递资源名称filename</li>
<li>定义Servlet</li>
<li>获取文件名称</li>
<li>使用字节输入流加载文件进内存</li>
<li>指定response的响应头： content-disposition:attachment;filename=xxx</li>
<li>将数据写出到response输出流</li>
</ol>

      </div>
      
      <footer class="post-footer">
        
        <nav class="post-nav"><a class="prev" href="/2020/05/21/Java/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Java/网络编程</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    <a class="next" href="/2020/05/21/Java/08-File%E7%B1%BB%E4%B8%8EIO%E6%B5%81/day09%E3%80%90%E5%AD%97%E8%8A%82%E6%B5%81%E3%80%81%E5%AD%97%E7%AC%A6%E6%B5%81%E3%80%91/">
        <span class="next-text nav-default">Java/08-File类与IO流/day09【字节流、字符流】</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></footer>
    </article></div><div class="comments" id="comments"></div></div>
      </main>

      <footer id="footer" class="footer"><div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even" target="_blank" rel="noopener">Even</a>
  </span>

  <span class="copyright-year">&copy;2020<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Gloomy楠</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v="></script>
</body>
</html>
